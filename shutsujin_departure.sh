#!/bin/bash
# ğŸ¯ multi-agent-daimyo å‡ºé™£ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆæ¯æ—¥ã®èµ·å‹•ç”¨ï¼‰
# Daily Deployment Script for Multi-Agent Orchestration System
#
# ä½¿ç”¨æ–¹æ³•:
#   ./shutsujin_departure.sh           # å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆèµ·å‹•ï¼ˆé€šå¸¸ï¼‰
#   ./shutsujin_departure.sh -s        # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ã¿ï¼ˆClaudeèµ·å‹•ãªã—ï¼‰
#   ./shutsujin_departure.sh -h        # ãƒ˜ãƒ«ãƒ—è¡¨ç¤º

set -e

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ãƒ­ã‚±ãƒ¼ãƒ«è¨­å®šï¼ˆæ—¥æœ¬èªæ–‡å­—åŒ–ã‘å¯¾ç­–ï¼‰
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
export LANG=ja_JP.UTF-8
export LC_ALL=ja_JP.UTF-8

# ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å–å¾—
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
cd "$SCRIPT_DIR"

# CLIã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’èª­ã¿è¾¼ã¿ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆã®ã¿ï¼‰
if [ -f "${SCRIPT_DIR}/lib/cli_adapter.sh" ]; then
    source "${SCRIPT_DIR}/lib/cli_adapter.sh"
    CLI_ADAPTER_AVAILABLE=true
else
    CLI_ADAPTER_AVAILABLE=false
fi

# è¨€èªè¨­å®šã‚’èª­ã¿å–ã‚Šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: jaï¼‰
LANG_SETTING="ja"
if [ -f "./config/settings.yaml" ]; then
    LANG_SETTING=$(grep "^language:" ./config/settings.yaml 2>/dev/null | awk '{print $2}' || echo "ja")
fi

# ã‚·ã‚§ãƒ«è¨­å®šã‚’èª­ã¿å–ã‚Šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: bashï¼‰
SHELL_SETTING="bash"
if [ -f "./config/settings.yaml" ]; then
    SHELL_SETTING=$(grep "^shell:" ./config/settings.yaml 2>/dev/null | awk '{print $2}' || echo "bash")
fi

# è‰²ä»˜ããƒ­ã‚°é–¢æ•°ï¼ˆæˆ¦å›½é¢¨ï¼‰
log_info() {
    echo -e "\033[1;33mã€å ±ã€‘\033[0m $1"
}

log_success() {
    echo -e "\033[1;32mã€æˆã€‘\033[0m $1"
}

log_war() {
    echo -e "\033[1;31mã€æˆ¦ã€‘\033[0m $1"
}

log_error() {
    echo -e "\033[1;31mã€æ•—ã€‘\033[0m $1"
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆé–¢æ•°ï¼ˆbash/zshå¯¾å¿œï¼‰
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ä½¿ç”¨æ³•: generate_prompt "ãƒ©ãƒ™ãƒ«" "è‰²" "ã‚·ã‚§ãƒ«"
# è‰²: red, green, blue, magenta, cyan, yellow
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
generate_prompt() {
    local label="$1"
    local color="$2"
    local shell_type="$3"

    if [ "$shell_type" == "zsh" ]; then
        # zshç”¨: %F{color}%B...%b%f å½¢å¼
        echo "(%F{${color}}%B${label}%b%f) %F{green}%B%~%b%f%# "
    else
        # bashç”¨: \[\033[...m\] å½¢å¼
        local color_code
        case "$color" in
            red)     color_code="1;31" ;;
            green)   color_code="1;32" ;;
            yellow)  color_code="1;33" ;;
            blue)    color_code="1;34" ;;
            magenta) color_code="1;35" ;;
            cyan)    color_code="1;36" ;;
            *)       color_code="1;37" ;;  # white (default)
        esac
        echo "(\[\033[${color_code}m\]${label}\[\033[0m\]) \[\033[1;32m\]\w\[\033[0m\]\$ "
    fi
}

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ã‚ªãƒ—ã‚·ãƒ§ãƒ³è§£æ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SETUP_ONLY=false
OPEN_TERMINAL=false
SHELL_OVERRIDE=""
FORCE_CLI=""

while [[ $# -gt 0 ]]; do
    case $1 in
        -s|--setup-only)
            SETUP_ONLY=true
            shift
            ;;
        -t|--terminal)
            OPEN_TERMINAL=true
            shift
            ;;
        --claude)
            FORCE_CLI="claude"
            shift
            ;;
        --copilot)
            FORCE_CLI="copilot"
            shift
            ;;
        --codex)
            FORCE_CLI="codex"
            shift
            ;;
        --crush)
            FORCE_CLI="crush"
            shift
            ;;
        --goose)
            FORCE_CLI="goose"
            shift
            ;;
        --gemini)
            FORCE_CLI="gemini"
            shift
            ;;
        -shell|--shell)
            if [[ -n "$2" && "$2" != -* ]]; then
                SHELL_OVERRIDE="$2"
                shift 2
            else
                echo "ã‚¨ãƒ©ãƒ¼: -shell ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã¯ bash ã¾ãŸã¯ zsh ã‚’æŒ‡å®šã—ã¦ãã ã•ã„"
                exit 1
            fi
            ;;
        -h|--help)
            echo ""
            echo "ğŸ¯ multi-agent-daimyo å‡ºé™£ã‚¹ã‚¯ãƒªãƒ—ãƒˆ"
            echo ""
            echo "ä½¿ç”¨æ–¹æ³•: ./shutsujin_departure.sh [ã‚ªãƒ—ã‚·ãƒ§ãƒ³]"
            echo ""
            echo "ã‚ªãƒ—ã‚·ãƒ§ãƒ³:"
            echo "  -s, --setup-only    tmuxã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ã¿ï¼ˆAI CLIèµ·å‹•ãªã—ï¼‰"
            echo "  -t, --terminal      Windows Terminal ã§æ–°ã—ã„ã‚¿ãƒ–ã‚’é–‹ã"
            echo "  --claude            Claude Code ã‚’å¼·åˆ¶ä½¿ç”¨ï¼ˆè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç„¡è¦–ï¼‰"
            echo "  --copilot           GitHub Copilot CLI ã‚’å¼·åˆ¶ä½¿ç”¨"
            echo "  --codex             Codex CLI ã‚’å¼·åˆ¶ä½¿ç”¨"
            echo "  --crush             Crush CLI ã‚’å¼·åˆ¶ä½¿ç”¨ï¼ˆCharmbraceletï¼‰"
            echo "  --goose             Goose CLI ã‚’å¼·åˆ¶ä½¿ç”¨ï¼ˆBlockï¼‰"
            echo "  --gemini            Gemini CLI ã‚’å¼·åˆ¶ä½¿ç”¨"
            echo "  -shell, --shell SH  ã‚·ã‚§ãƒ«ã‚’æŒ‡å®šï¼ˆbash ã¾ãŸã¯ zshï¼‰"
            echo "                      æœªæŒ‡å®šæ™‚ã¯ config/settings.yaml ã®è¨­å®šã‚’ä½¿ç”¨"
            echo "  -h, --help          ã“ã®ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º"
            echo ""
            echo "OpenAIäº’æ›ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆGLMç­‰ï¼‰:"
            echo "  settings.yaml ã§ backend è¨­å®šã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„"
            echo ""
            echo "ä¾‹:"
            echo "  ./shutsujin_departure.sh              # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«å¾“ã£ã¦èµ·å‹•"
            echo "  ./shutsujin_departure.sh --claude     # Claude Code ã§èµ·å‹•"
            echo "  ./shutsujin_departure.sh --crush      # Crush CLI ã§èµ·å‹•"
            echo "  ./shutsujin_departure.sh -s           # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ã¿ï¼ˆæ‰‹å‹•ã§CLIèµ·å‹•ï¼‰"
            echo "  ./shutsujin_departure.sh -t           # å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆèµ·å‹• + ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¿ãƒ–å±•é–‹"
            echo "  ./shutsujin_departure.sh -shell bash  # bashç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§èµ·å‹•"
            echo "  ./shutsujin_departure.sh -shell zsh   # zshç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§èµ·å‹•"
            echo ""
            echo "ã‚¨ã‚¤ãƒªã‚¢ã‚¹:"
            echo "  csst  â†’ cd /mnt/c/tools/multi-agent-daimyo && ./shutsujin_departure.sh"
            echo "  csk   â†’ tmux attach-session -t karo"
            echo "  csm   â†’ tmux attach-session -t multiagent"
            echo ""
            exit 0
            ;;
        *)
            echo "ä¸æ˜ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³: $1"
            echo "./shutsujin_departure.sh -h ã§ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º"
            exit 1
            ;;
    esac
done

# ã‚·ã‚§ãƒ«è¨­å®šã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ï¼ˆã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³å„ªå…ˆï¼‰
if [ -n "$SHELL_OVERRIDE" ]; then
    if [[ "$SHELL_OVERRIDE" == "bash" || "$SHELL_OVERRIDE" == "zsh" ]]; then
        SHELL_SETTING="$SHELL_OVERRIDE"
    else
        echo "ã‚¨ãƒ©ãƒ¼: -shell ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã¯ bash ã¾ãŸã¯ zsh ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ï¼ˆæŒ‡å®šå€¤: $SHELL_OVERRIDEï¼‰"
        exit 1
    fi
fi

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# å‡ºé™£ãƒãƒŠãƒ¼è¡¨ç¤ºï¼ˆCC0ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ASCIIã‚¢ãƒ¼ãƒˆä½¿ç”¨ï¼‰
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ã€è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹è¡¨ç¤ºã€‘
# å¿è€…ASCIIã‚¢ãƒ¼ãƒˆ: syntax-samurai/ryu - CC0 1.0 Universal (Public Domain)
# å‡ºå…¸: https://github.com/syntax-samurai/ryu
# "all files and scripts in this repo are released CC0 / kopimi!"
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
show_battle_cry() {
    clear

    # ã‚¿ã‚¤ãƒˆãƒ«ãƒãƒŠãƒ¼ï¼ˆè‰²ä»˜ãï¼‰
    echo ""
    echo -e "\033[1;31mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\033[0m"
    echo -e "\033[1;31mâ•‘\033[0m \033[1;33mâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—\033[0m \033[1;31mâ•‘\033[0m"
    echo -e "\033[1;31mâ•‘\033[0m \033[1;33mâ–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘\033[0m \033[1;31mâ•‘\033[0m"
    echo -e "\033[1;31mâ•‘\033[0m \033[1;33mâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘\033[0m \033[1;31mâ•‘\033[0m"
    echo -e "\033[1;31mâ•‘\033[0m \033[1;33mâ•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆ   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘\033[0m \033[1;31mâ•‘\033[0m"
    echo -e "\033[1;31mâ•‘\033[0m \033[1;33mâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘\033[0m \033[1;31mâ•‘\033[0m"
    echo -e "\033[1;31mâ•‘\033[0m \033[1;33mâ•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â•    â•šâ•â•   â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â• â•šâ•â•â•šâ•â•  â•šâ•â•â•â•\033[0m \033[1;31mâ•‘\033[0m"
    echo -e "\033[1;31mâ• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£\033[0m"
    echo -e "\033[1;31mâ•‘\033[0m       \033[1;37må‡ºé™£ã˜ã‚ƒãƒ¼ãƒ¼ãƒ¼ï¼ï¼ï¼\033[0m    \033[1;36mâš”\033[0m    \033[1;35må¤©ä¸‹å¸ƒæ­¦ï¼\033[0m                          \033[1;31mâ•‘\033[0m"
    echo -e "\033[1;31mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\033[0m"
    echo ""

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # è¶³è»½éšŠåˆ—ï¼ˆã‚ªãƒªã‚¸ãƒŠãƒ«ï¼‰
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    echo -e "\033[1;34m  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\033[0m"
    echo -e "\033[1;34m  â•‘\033[0m                    \033[1;37mã€ è¶³ è»½ éšŠ åˆ— ãƒ» å…« å é… å‚™ ã€‘\033[0m                      \033[1;34mâ•‘\033[0m"
    echo -e "\033[1;34m  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\033[0m"

    cat << 'ASHIGARU_EOF'

       /\      /\      /\      /\      /\      /\      /\      /\
      /||\    /||\    /||\    /||\    /||\    /||\    /||\    /||\
     /_||\   /_||\   /_||\   /_||\   /_||\   /_||\   /_||\   /_||\
       ||      ||      ||      ||      ||      ||      ||      ||
      /||\    /||\    /||\    /||\    /||\    /||\    /||\    /||\
      /  \    /  \    /  \    /  \    /  \    /  \    /  \    /  \
     [è¶³1]   [è¶³2]   [è¶³3]   [è¶³4]   [è¶³5]   [è¶³6]   [è¶³7]   [è¶³8]

ASHIGARU_EOF

    echo -e "                    \033[1;36mã€Œã€Œã€Œ ã¯ã£ï¼ï¼ å‡ºé™£ã„ãŸã™ï¼ï¼ ã€ã€ã€\033[0m"
    echo ""

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    echo -e "\033[1;33m  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\033[0m"
    echo -e "\033[1;33m  â”ƒ\033[0m  \033[1;37mğŸ¯ multi-agent-daimyo\033[0m  ã€œ \033[1;36mæˆ¦å›½ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçµ±ç‡ã‚·ã‚¹ãƒ†ãƒ \033[0m ã€œ           \033[1;33mâ”ƒ\033[0m"
    echo -e "\033[1;33m  â”ƒ\033[0m                                                                           \033[1;33mâ”ƒ\033[0m"
    echo -e "\033[1;33m  â”ƒ\033[0m    \033[1;35må®¶è€\033[0m: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçµ±æ‹¬    \033[1;31méƒ¨å°†\033[0m: ã‚¿ã‚¹ã‚¯ç®¡ç†    \033[1;34mè¶³è»½\033[0m: å®Ÿåƒéƒ¨éšŠÃ—8      \033[1;33mâ”ƒ\033[0m"
    echo -e "\033[1;33m  â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\033[0m"
    echo ""
}

# ãƒãƒŠãƒ¼è¡¨ç¤ºå®Ÿè¡Œ
show_battle_cry

echo -e "  \033[1;33må¤©ä¸‹å¸ƒæ­¦ï¼é™£ç«‹ã¦ã‚’é–‹å§‹ã„ãŸã™\033[0m (Setting up the battlefield)"
echo ""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 1: æ—¢å­˜ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
log_info "ğŸ§¹ æ—¢å­˜ã®é™£ã‚’æ’¤åä¸­..."
tmux kill-session -t multiagent 2>/dev/null && log_info "  â””â”€ multiagenté™£ã€æ’¤åå®Œäº†" || log_info "  â””â”€ multiagenté™£ã¯å­˜åœ¨ã›ãš"
tmux kill-session -t karo 2>/dev/null && log_info "  â””â”€ karoæœ¬é™£ã€æ’¤åå®Œäº†" || log_info "  â””â”€ karoæœ¬é™£ã¯å­˜åœ¨ã›ãš"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 1.5: å‰å›è¨˜éŒ²ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆå†…å®¹ãŒã‚ã‚‹å ´åˆã®ã¿ï¼‰
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
BACKUP_DIR="./logs/backup_$(date '+%Y%m%d_%H%M%S')"
NEED_BACKUP=false

if [ -f "./dashboard.md" ]; then
    if grep -q "cmd_" "./dashboard.md" 2>/dev/null; then
        NEED_BACKUP=true
    fi
fi

# éƒ¨å°†ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆãŒå­˜åœ¨ã™ã‚‹å ´åˆã‚‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¯¾è±¡
if [ -f "./queue/checkpoint/busho_checkpoint.yaml" ]; then
    NEED_BACKUP=true
fi

if [ "$NEED_BACKUP" = true ]; then
    mkdir -p "$BACKUP_DIR" || true
    cp "./dashboard.md" "$BACKUP_DIR/" 2>/dev/null || true
    cp -r "./queue/reports" "$BACKUP_DIR/" 2>/dev/null || true
    cp -r "./queue/tasks" "$BACKUP_DIR/" 2>/dev/null || true
    cp "./queue/karo_to_busho.yaml" "$BACKUP_DIR/" 2>/dev/null || true
    # éƒ¨å°†ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
    if [ -f "./queue/checkpoint/busho_checkpoint.yaml" ]; then
        mkdir -p "$BACKUP_DIR/checkpoint" || true
        cp "./queue/checkpoint/busho_checkpoint.yaml" "$BACKUP_DIR/checkpoint/" 2>/dev/null || true
        log_info "ğŸ“¦ éƒ¨å°†ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: $BACKUP_DIR/checkpoint/"
    fi
    log_info "ğŸ“¦ å‰å›ã®è¨˜éŒ²ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: $BACKUP_DIR"
fi

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 2: å ±å‘Šãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚»ãƒƒãƒˆ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
log_info "ğŸ“œ å‰å›ã®è»è­°è¨˜éŒ²ã‚’ç ´æ£„ä¸­..."

# queue ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ
[ -d ./queue/reports ] || mkdir -p ./queue/reports
[ -d ./queue/tasks ] || mkdir -p ./queue/tasks
[ -d ./queue/checkpoint ] || mkdir -p ./queue/checkpoint

# éƒ¨å°†ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’åˆæœŸåŒ–ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ›¸ãå‡ºã—ï¼‰
CHECKPOINT_TIMESTAMP=$(date "+%Y-%m-%dT%H:%M:%S")
cat > ./queue/checkpoint/busho_checkpoint.yaml << EOF
# éƒ¨å°†ã®é€²æ—ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ
# Gitç®¡ç†å¯¾è±¡å¤–ï¼ˆ.gitignore ã«ç™»éŒ²æ¸ˆã¿ï¼‰
# å‡ºé™£æ™‚ã«è‡ªå‹•ä½œæˆãƒ»ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹

current_cmd: null
updated_at: "${CHECKPOINT_TIMESTAMP}"
phase: idle  # idle | received | distributed | in_progress | review_pending | done

task_progress:
  total: 0
  completed: 0
  by_priority:
    critical: { total: 0, done: 0 }
    high: { total: 0, done: 0 }
    medium: { total: 0, done: 0 }
    low: { total: 0, done: 0 }

ashigaru_daisho_status: idle  # è¶³è»½å¤§å°†ã¯åˆ¥ç®¡ç†ï¼ˆå®Ÿä½œæ¥­ãªã—ï¼‰

ashigaru_status:
  ashigaru2: { task: null, status: idle }
  ashigaru3: { task: null, status: idle }
  ashigaru4: { task: null, status: idle }
  ashigaru5: { task: null, status: idle }
  ashigaru6: { task: null, status: idle }
  ashigaru7: { task: null, status: idle }
  ashigaru8: { task: null, status: idle }

checklist:
  all_tasks_complete: false
  build_verified: false
  test_verified: false
  coderabbit_review: pending
  coderabbit_issues_resolved: false
  dashboard_updated: false

next_action: "å®¶è€ã‹ã‚‰ã®æŒ‡ç¤ºã‚’å¾…ã¤"

notes: |
  å‡ºé™£æ™‚ã«è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€‚
  cmdå—é ˜æ™‚ã«éƒ¨å°†ãŒæ›´æ–°ã™ã‚‹ã€‚
EOF
log_info "  â””â”€ éƒ¨å°†ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆåˆæœŸåŒ–å®Œäº†"

# è¶³è»½ã‚¿ã‚¹ã‚¯ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚»ãƒƒãƒˆï¼ˆè¶³è»½2-8ã®ã¿ã€‚è¶³è»½å¤§å°†ã¯å®Ÿä½œæ¥­ã—ãªã„ï¼‰
for i in {2..8}; do
    cat > ./queue/tasks/ashigaru${i}.yaml << EOF
# è¶³è»½${i}å°‚ç”¨ã‚¿ã‚¹ã‚¯ãƒ•ã‚¡ã‚¤ãƒ«
task:
  task_id: null
  parent_cmd: null
  description: null
  target_path: null
  status: idle
  timestamp: ""
EOF
done

# è¶³è»½ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚»ãƒƒãƒˆï¼ˆè¶³è»½2-8ã®ã¿ï¼‰
for i in {2..8}; do
    cat > ./queue/reports/ashigaru${i}_report.yaml << EOF
worker_id: ashigaru${i}
task_id: null
timestamp: ""
status: idle
result: null
EOF
done

# ã‚­ãƒ¥ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚»ãƒƒãƒˆ
cat > ./queue/karo_to_busho.yaml << 'EOF'
queue: []
EOF

cat > ./queue/busho_to_ashigaru.yaml << 'EOF'
queue: []
EOF

log_success "âœ… é™£æ‰•ã„å®Œäº†"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 3: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰åˆæœŸåŒ–
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
log_info "ğŸ“Š æˆ¦æ³å ±å‘Šæ¿ã‚’åˆæœŸåŒ–ä¸­..."
TIMESTAMP=$(date "+%Y-%m-%d %H:%M")

if [ "$LANG_SETTING" = "ja" ]; then
    # æ—¥æœ¬èªã®ã¿
    cat > ./dashboard.md << EOF
# ğŸ“Š æˆ¦æ³å ±å‘Š
æœ€çµ‚æ›´æ–°: ${TIMESTAMP}

## ğŸš¨ è¦å¯¾å¿œ - æ®¿ã®ã”åˆ¤æ–­ã‚’ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™
ãªã—

## ğŸ”„ é€²è¡Œä¸­ - åªä»Šã€æˆ¦é—˜ä¸­ã§ã”ã–ã‚‹
ãªã—

## âœ… æœ¬æ—¥ã®æˆ¦æœ
| æ™‚åˆ» | æˆ¦å ´ | ä»»å‹™ | çµæœ |
|------|------|------|------|

## ğŸ¯ ã‚¹ã‚­ãƒ«åŒ–å€™è£œ - æ‰¿èªå¾…ã¡
ãªã—

## ğŸ› ï¸ ç”Ÿæˆã•ã‚ŒãŸã‚¹ã‚­ãƒ«
ãªã—

## â¸ï¸ å¾…æ©Ÿä¸­
ãªã—

## â“ ä¼ºã„äº‹é …
ãªã—
EOF
else
    # æ—¥æœ¬èª + ç¿»è¨³ä½µè¨˜
    cat > ./dashboard.md << EOF
# ğŸ“Š æˆ¦æ³å ±å‘Š (Battle Status Report)
æœ€çµ‚æ›´æ–° (Last Updated): ${TIMESTAMP}

## ğŸš¨ è¦å¯¾å¿œ - æ®¿ã®ã”åˆ¤æ–­ã‚’ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ (Action Required - Awaiting Lord's Decision)
ãªã— (None)

## ğŸ”„ é€²è¡Œä¸­ - åªä»Šã€æˆ¦é—˜ä¸­ã§ã”ã–ã‚‹ (In Progress - Currently in Battle)
ãªã— (None)

## âœ… æœ¬æ—¥ã®æˆ¦æœ (Today's Achievements)
| æ™‚åˆ» (Time) | æˆ¦å ´ (Battlefield) | ä»»å‹™ (Mission) | çµæœ (Result) |
|------|------|------|------|

## ğŸ¯ ã‚¹ã‚­ãƒ«åŒ–å€™è£œ - æ‰¿èªå¾…ã¡ (Skill Candidates - Pending Approval)
ãªã— (None)

## ğŸ› ï¸ ç”Ÿæˆã•ã‚ŒãŸã‚¹ã‚­ãƒ« (Generated Skills)
ãªã— (None)

## â¸ï¸ å¾…æ©Ÿä¸­ (On Standby)
ãªã— (None)

## â“ ä¼ºã„äº‹é … (Questions for Lord)
ãªã— (None)
EOF
fi

log_success "  â””â”€ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰åˆæœŸåŒ–å®Œäº† (è¨€èª: $LANG_SETTING, ã‚·ã‚§ãƒ«: $SHELL_SETTING)"
echo ""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 4: multiagentã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆï¼ˆ9ãƒšã‚¤ãƒ³ï¼šbusho + ashigaru1-8ï¼‰
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# tmux ã®å­˜åœ¨ç¢ºèª
if ! command -v tmux &> /dev/null; then
    echo ""
    echo "  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "  â•‘  [ERROR] tmux not found!                               â•‘"
    echo "  â•‘  tmux ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“                                    â•‘"
    echo "  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
    echo "  â•‘  Run first_setup.sh first:                             â•‘"
    echo "  â•‘  ã¾ãš first_setup.sh ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„:                   â•‘"
    echo "  â•‘     ./first_setup.sh                                   â•‘"
    echo "  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    exit 1
fi

log_war "âš”ï¸ éƒ¨å°†ãƒ»è¶³è»½å¤§å°†ãƒ»è¶³è»½ã®é™£ã‚’æ§‹ç¯‰ä¸­ï¼ˆ9åé…å‚™ï¼‰..."

# æœ€åˆã®ãƒšã‚¤ãƒ³ä½œæˆï¼ˆ-u: UTF-8å¼·åˆ¶ãƒ¢ãƒ¼ãƒ‰ï¼‰
if ! tmux -u new-session -d -s multiagent -n "agents" 2>/dev/null; then
    echo ""
    echo "  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "  â•‘  [ERROR] Failed to create tmux session 'multiagent'        â•‘"
    echo "  â•‘  tmux ã‚»ãƒƒã‚·ãƒ§ãƒ³ 'multiagent' ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ              â•‘"
    echo "  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
    echo "  â•‘  An existing session may be running.                       â•‘"
    echo "  â•‘  æ—¢å­˜ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæ®‹ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™                       â•‘"
    echo "  â•‘                                                            â•‘"
    echo "  â•‘  Check: tmux ls                                            â•‘"
    echo "  â•‘  Kill:  tmux kill-session -t multiagent                    â•‘"
    echo "  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    exit 1
fi

# 3x3ã‚°ãƒªãƒƒãƒ‰ä½œæˆï¼ˆåˆè¨ˆ9ãƒšã‚¤ãƒ³ï¼‰
# æœ€åˆã«3åˆ—ã«åˆ†å‰²
tmux split-window -h -t "multiagent:0"
tmux split-window -h -t "multiagent:0"

# å„åˆ—ã‚’3è¡Œã«åˆ†å‰²
tmux select-pane -t "multiagent:0.0"
tmux split-window -v
tmux split-window -v

tmux select-pane -t "multiagent:0.3"
tmux split-window -v
tmux split-window -v

tmux select-pane -t "multiagent:0.6"
tmux split-window -v
tmux split-window -v

# ãƒšã‚¤ãƒ³ã‚¿ã‚¤ãƒˆãƒ«è¨­å®šï¼ˆ0: busho, 1: ashigaru-daisho, 2-8: ashigaru2-8ï¼‰
PANE_TITLES=("busho" "ashigaru-daisho" "ashigaru2" "ashigaru3" "ashigaru4" "ashigaru5" "ashigaru6" "ashigaru7" "ashigaru8")
# è‰²è¨­å®šï¼ˆbusho: èµ¤, ashigaru-daisho: é»„, ashigaru: é’ï¼‰
PANE_COLORS=("red" "yellow" "blue" "blue" "blue" "blue" "blue" "blue" "blue")

for i in {0..8}; do
    tmux select-pane -t "multiagent:0.$i" -T "${PANE_TITLES[$i]}"
    PROMPT_STR=$(generate_prompt "${PANE_TITLES[$i]}" "${PANE_COLORS[$i]}" "$SHELL_SETTING")
    # ãƒ­ã‚±ãƒ¼ãƒ«è¨­å®š + ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹• + ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­å®š + ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆIDç’°å¢ƒå¤‰æ•°
    # AGENT_ID: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè­˜åˆ¥å­ï¼ˆbusho, ashigaru-daisho, ashigaru2-8ï¼‰
    # AGENT_PANE: tmuxãƒšã‚¤ãƒ³ç•ªå·ï¼ˆ0-8ï¼‰
    tmux send-keys -t "multiagent:0.$i" "export LANG=ja_JP.UTF-8 && export LC_ALL=ja_JP.UTF-8 && export AGENT_ID='${PANE_TITLES[$i]}' && export AGENT_PANE='$i' && cd \"$(pwd)\" && export PS1='${PROMPT_STR}' && clear" Enter
done

log_success "  â””â”€ éƒ¨å°†ãƒ»è¶³è»½ã®é™£ã€æ§‹ç¯‰å®Œäº†"
echo ""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 5: karoã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆï¼ˆ1ãƒšã‚¤ãƒ³ï¼‰
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
log_war "ğŸ‘‘ å®¶è€ã®æœ¬é™£ã‚’æ§‹ç¯‰ä¸­..."
if ! tmux -u new-session -d -s karo 2>/dev/null; then
    echo ""
    echo "  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
    echo "  â•‘  [ERROR] Failed to create tmux session 'karo'              â•‘"
    echo "  â•‘  tmux ã‚»ãƒƒã‚·ãƒ§ãƒ³ 'karo' ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ                    â•‘"
    echo "  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
    echo "  â•‘  An existing session may be running.                       â•‘"
    echo "  â•‘  æ—¢å­˜ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæ®‹ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™                       â•‘"
    echo "  â•‘                                                            â•‘"
    echo "  â•‘  Check: tmux ls                                            â•‘"
    echo "  â•‘  Kill:  tmux kill-session -t karo                          â•‘"
    echo "  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    exit 1
fi
KARO_PROMPT=$(generate_prompt "å®¶è€" "magenta" "$SHELL_SETTING")
# ãƒ­ã‚±ãƒ¼ãƒ«è¨­å®š + ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹• + ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­å®š
tmux send-keys -t karo "export LANG=ja_JP.UTF-8 && export LC_ALL=ja_JP.UTF-8 && cd \"$(pwd)\" && export PS1='${KARO_PROMPT}' && clear" Enter
tmux select-pane -t karo:0.0 -P 'bg=#002b36'  # å®¶è€ã® Solarized Dark

log_success "  â””â”€ å®¶è€ã®æœ¬é™£ã€æ§‹ç¯‰å®Œäº†"
echo ""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 5.5: è¶³è»½åç°¿ã®è‡ªå‹•ç”Ÿæˆï¼ˆãƒãƒ«ãƒCLIãƒ¢ãƒ¼ãƒ‰æ™‚ã®ã¿ï¼‰
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
if [ "$CLI_ADAPTER_AVAILABLE" = true ] && [ -f "./config/settings.yaml" ]; then
    log_info "ğŸ“‹ è¶³è»½åç°¿ã‚’ç”Ÿæˆä¸­..."
    generate_agent_roster "./config/settings.yaml" "./status/agent_roster.md"
    log_success "  â””â”€ status/agent_roster.md ç”Ÿæˆå®Œäº†"
    echo ""
fi

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 6: AI CLI èµ·å‹•ï¼ˆ--setup-only ã§ã‚¹ã‚­ãƒƒãƒ—ï¼‰
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
if [ "$SETUP_ONLY" = false ]; then
    if [ "$CLI_ADAPTER_AVAILABLE" = true ]; then
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # ãƒãƒ«ãƒCLIå¯¾å¿œãƒ¢ãƒ¼ãƒ‰
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        CONFIG_FILE="./config/settings.yaml"

        log_war "ğŸ‘‘ å…¨è»ã«AI CLIã‚’å¬å–šä¸­..."

        # å®¶è€
        log_info "  â”œâ”€ å®¶è€ã‚’å¬å–šä¸­..."

        if [ -n "$FORCE_CLI" ]; then
            KARO_CLI="$FORCE_CLI"
        else
            KARO_CLI=$(get_cli_type "karo" "$CONFIG_FILE")
        fi

        if ! validate_cli_availability "$KARO_CLI"; then
            echo "  å®¶è€ã®CLI ($KARO_CLI) ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“"
            exit 1
        fi

        KARO_CMD=$(build_cli_command "karo" "$KARO_CLI" "$CONFIG_FILE")

        # å®¶è€å›ºæœ‰ã®ç’°å¢ƒå¤‰æ•°è¨­å®šï¼ˆClaude Code ã®å ´åˆï¼‰
        if [ "$KARO_CLI" = "claude" ]; then
            if ! echo "$KARO_CMD" | grep -q "MAX_THINKING_TOKENS"; then
                KARO_CMD="MAX_THINKING_TOKENS=0 $KARO_CMD"
            fi
            if ! echo "$KARO_CMD" | grep -q -- "--model"; then
                KARO_CMD=$(echo "$KARO_CMD" | sed 's/claude /claude --model opus /')
            fi
        fi

        tmux send-keys -t karo "$KARO_CMD"
        tmux send-keys -t karo Enter

        # Claude Code ã®è¨±å¯ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ "Yes, I accept" ã‚’é¸æŠ
        if [ "$KARO_CLI" = "claude" ]; then
            sleep 2  # ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤ºã‚’å¾…æ©Ÿ
            tmux send-keys -t karo Down   # ã€ŒYes, I acceptã€ã‚’é¸æŠ
            tmux send-keys -t karo Enter  # ç¢ºå®š
        fi

        CLI_ICON=$(get_cli_icon "$KARO_CLI")
        CLI_NAME=$(get_cli_display_name "$KARO_CLI")
        log_info "  â”‚  â””â”€ å®¶è€ã€å¬å–šå®Œäº† $CLI_ICON ($CLI_NAME)"

        # Copilot/GLMç­‰ç”¨æŒ‡ç¤ºæ›¸ã‚’ç”Ÿæˆ
        if [ "$KARO_CLI" != "claude" ]; then
            generate_cli_instructions "karo" "$KARO_CLI" "./instructions" "./.github/copilot-instructions-karo.md" 2>/dev/null || true
        fi

        sleep 1

        # éƒ¨å°† + è¶³è»½å¤§å°† + è¶³è»½ï¼ˆ9ãƒšã‚¤ãƒ³ï¼‰
        log_info "  â”œâ”€ éƒ¨å°†ãƒ»è¶³è»½å¤§å°†ãƒ»è¶³è»½ã‚’å¬å–šä¸­..."
        AGENT_NAMES=("busho" "ashigaru-daisho" "ashigaru2" "ashigaru3" "ashigaru4" "ashigaru5" "ashigaru6" "ashigaru7" "ashigaru8")

        for i in {0..8}; do
            AGENT_NAME="${AGENT_NAMES[$i]}"

            if [ -n "$FORCE_CLI" ]; then
                AGENT_CLI="$FORCE_CLI"
            else
                AGENT_CLI=$(get_cli_type "$AGENT_NAME" "$CONFIG_FILE")
            fi

            if ! validate_cli_availability "$AGENT_CLI"; then
                echo "  $AGENT_NAME ã®CLI ($AGENT_CLI) ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“"
                exit 1
            fi

            AGENT_CMD=$(build_cli_command "$AGENT_NAME" "$AGENT_CLI" "$CONFIG_FILE")

            tmux send-keys -t "multiagent:0.$i" "$AGENT_CMD"
            tmux send-keys -t "multiagent:0.$i" Enter

            # Claude Code ã®è¨±å¯ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ "Yes, I accept" ã‚’é¸æŠ
            if [ "$AGENT_CLI" = "claude" ]; then
                sleep 1  # ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤ºã‚’å¾…æ©Ÿ
                tmux send-keys -t "multiagent:0.$i" Down   # ã€ŒYes, I acceptã€ã‚’é¸æŠ
                tmux send-keys -t "multiagent:0.$i" Enter  # ç¢ºå®š
            fi

            # CLIå›ºæœ‰ã®æŒ‡ç¤ºæ›¸ã‚’ç”Ÿæˆ
            if [ "$AGENT_CLI" != "claude" ]; then
                generate_cli_instructions "$AGENT_NAME" "$AGENT_CLI" "./instructions" "./.github/copilot-instructions-${AGENT_NAME}.md" 2>/dev/null || true
            fi
        done

        log_info "  â””â”€ éƒ¨å°†ãƒ»è¶³è»½ã€å¬å–šå®Œäº†"

        # CLIã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸèµ·å‹•å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        CLI_ICON=$(get_cli_icon "$KARO_CLI")
        CLI_NAME=$(get_cli_display_name "$KARO_CLI")
        log_success "âœ… å…¨è» $CLI_NAME èµ·å‹•å®Œäº† $CLI_ICON"
        echo ""
    else
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        # å¾“æ¥ãƒ¢ãƒ¼ãƒ‰ï¼ˆå¾Œæ–¹äº’æ›ï¼‰
        # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        if ! command -v claude &> /dev/null; then
            log_info "âš ï¸  claude ã‚³ãƒãƒ³ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
            echo "  first_setup.sh ã‚’å†å®Ÿè¡Œã—ã¦ãã ã•ã„:"
            echo "    ./first_setup.sh"
            exit 1
        fi

        # å¾“æ¥ãƒ¢ãƒ¼ãƒ‰ã§ã¯å¸¸ã«Claude Codeã‚’ä½¿ç”¨
        KARO_CLI="claude"

        log_war "ğŸ‘‘ å…¨è»ã« Claude Code ã‚’å¬å–šä¸­..."

        # å®¶è€
        tmux send-keys -t karo "MAX_THINKING_TOKENS=0 claude --model opus --dangerously-skip-permissions"
        tmux send-keys -t karo Enter
        sleep 2  # ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤ºã‚’å¾…æ©Ÿ
        tmux send-keys -t karo Down   # ã€ŒYes, I acceptã€ã‚’é¸æŠ
        tmux send-keys -t karo Enter  # ç¢ºå®š
        log_info "  â””â”€ å®¶è€ã€å¬å–šå®Œäº†"

        sleep 1

        # éƒ¨å°† + è¶³è»½ï¼ˆ9ãƒšã‚¤ãƒ³ï¼‰
        for i in {0..8}; do
            tmux send-keys -t "multiagent:0.$i" "claude --dangerously-skip-permissions"
            tmux send-keys -t "multiagent:0.$i" Enter
            sleep 1  # ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤ºã‚’å¾…æ©Ÿ
            tmux send-keys -t "multiagent:0.$i" Down   # ã€ŒYes, I acceptã€ã‚’é¸æŠ
            tmux send-keys -t "multiagent:0.$i" Enter  # ç¢ºå®š
        done
        log_info "  â””â”€ éƒ¨å°†ãƒ»è¶³è»½ã€å¬å–šå®Œäº†"

        log_success "âœ… å…¨è» Claude Code èµ·å‹•å®Œäº†"
        echo ""
    fi

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # STEP 6.5: å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æŒ‡ç¤ºæ›¸ã‚’èª­ã¿è¾¼ã¾ã›ã‚‹
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    log_war "ğŸ“œ å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æŒ‡ç¤ºæ›¸ã‚’èª­ã¿è¾¼ã¾ã›ä¸­..."
    echo ""

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # å¿è€…æˆ¦å£«ï¼ˆsyntax-samurai/ryu - CC0 1.0 Public Domainï¼‰
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    echo -e "\033[1;35m  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\033[0m"
    echo -e "\033[1;35m  â”‚\033[0m                              \033[1;37mã€ å¿ è€… æˆ¦ å£« ã€‘\033[0m  Ryu Hayabusa (CC0 Public Domain)                        \033[1;35mâ”‚\033[0m"
    echo -e "\033[1;35m  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\033[0m"

    cat << 'NINJA_EOF'
...................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’                        ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’                        ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’                        ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’                        ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’                        ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’                         ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’  â–’â–’â–’â–’â–’â–’â–‘â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’â–’                         ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’          â–’â–’â–’â–’â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’                             ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’               â–’â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’                                ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’                    â–’â–’â–’â–’â–‘â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’                                    ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’                            â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’                                        ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘      â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                                      â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘       â–’          ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–’    â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘                                 â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘               ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘     â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘                          â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–’  â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘             â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â–‘   â–’         ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘  â–’         ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â–‘    â–’        ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’  â–‘ â–‘               â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘                 â–‘            ...................................
.................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   â–‘â–‘â–‘  â–‘                 â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–“â–“â–“â–“â–‘â–‘â–‘â–“â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“                    â–‘ â–‘   â–’         ..................................
.................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’   â–‘â–‘â–‘â–‘â–‘ â–‘                  â–“â–“â–“â–“â–“â–“â–‘â–“â–“â–“â–“â–‘â–‘â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“                    â–‘  â–‘ â–‘  â–’         ..................................
.................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘                 â–‘â–“â–‘â–‘â–“â–“â–“â–“â–“â–‘â–“â–“â–“â–‘â–‘â–‘â–‘â–‘                   â–‘ â–‘â–‘ â–‘â–‘ â–‘   â–’         ..................................
.................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’    â–‘â–‘â–‘â–‘â–‘â–‘â–‘   â–‘â–‘                    â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘                   â–‘â–‘    â–‘ â–‘â–‘ â–‘    â–’        ..................................
.................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                      â–‘â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘                     â–‘â–‘â–‘  â–‘  â–‘ â–‘   â–’        ..................................
.................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–’    â–‘â–‘â–‘â–‘â–‘â–‘                         â–‘â–‘â–‘â–“â–“â–“â–‘â–“â–‘â–‘â–‘â–‘      â–‘                  â–‘ â–‘â–‘ â–‘    â–’        ..................................
.................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–’    â–‘â–‘â–‘â–‘â–‘â–‘â–‘     â–“â–“        â–“  â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â–‘   â–‘â–‘  â–“        â–ˆâ–“       â–‘  â–‘ â–‘   â–’â–’       ..................................
..................................â–‘â–‘â–‘â–‘â–‘â–’ â–’    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â–“â–“â–ˆâ–ˆ  â–“  â–ˆâ–ˆ â–ˆâ–ˆâ–“  â–“ â–‘â–‘â–‘â–“â–‘  â–‘ â–‘ â–‘â–‘â–‘â–‘  â–“   â–ˆâ–ˆ â–“â–ˆ  â–“  â–ˆâ–ˆâ–“â–“  â–‘â–‘â–‘â–‘  â–‘ â–‘    â–’      ...................................
..................................â–‘â–‘â–‘â–‘â–‘â–’ â–’â–’   â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â–“â–ˆâ–ˆ  â–“â–“  â–“ â–ˆâ–ˆâ–“  â–“â–‘â–‘â–‘â–‘â–“â–“â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–“  â–“â–ˆâ–ˆ â–“   â–“  â–ˆâ–ˆâ–“â–“ â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘     â–’      ...................................
..................................â–‘â–‘â–‘â–‘â–‘  â–’â–‘   â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–‘â–‘ â–“â–ˆâ–ˆâ–ˆ  â–“â–“â–“â–“ â–ˆâ–ˆâ–ˆâ–‘  â–‘â–‘â–‘â–‘â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    â–‘â–“â–ˆâ–ˆ  â–“â–“â–“  â–ˆâ–ˆâ–ˆâ–“ â–‘â–‘â–“â–“â–‘â–‘  â–‘    â–’ â–’      ...................................
...................................â–‘â–‘â–‘â–‘  â–’â–‘    â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–‘  â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆ      â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘     â–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–“â–“â–“â–“â–‘â–‘  â–‘    â–’ â–’      ...................................
...................................â–‘â–‘â–‘â–‘ â–’ â–‘â–’    â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–“â–“â–“â–‘â–‘ â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘    â–’â–’ â–’      ...................................
...................................â–‘â–‘â–‘â–‘ â–‘ â–‘â–‘     â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘ â–‘â–‘   â–‘â–‘â–“â–‘â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–‘â–‘      â–’â–’ â–’      ...................................
...................................â–‘â–‘â–‘â–‘ â–‘ â–‘â–‘      â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–ˆâ–ˆ  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘   â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–‘â–‘ â–‘    â–’â–’  â–’      ...................................
...................................â–‘â–‘â–‘â–‘â–’â–‘â–‘â–’â–‘â–‘      â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–‘â–‘â–‘â–‘      â–’â–’  â–’     ....................................
...................................â–‘â–‘â–‘â–‘â–’â–‘â–‘ â–‘â–‘       â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘        â–’â–’  â–’     ....................................
...................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–’â–‘â–’       â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–“â–“â–“â–‘â–‘   â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘         â–’   â–’     ....................................
...................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘           â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“              â–‘    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘            â–’   â–’     ....................................
....................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’  â–’â–’        â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’                         â–’â–’â–’â–’â–’   â–’    â–’    .....................................
....................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–’ â–’â–’â–’â–‘â–‘â–‘        â–“â–“â–“â–“â–“â–“   â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’      â–’â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–’â–’    â–’â–’â–’â–’â–’â–’â–’  â–’â–’    â–’    .....................................
....................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘ â–’â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘          â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–‘â–’     â–’â–’â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–‘â–’â–’â–’â–’   â–’â–’         .....................................
.....................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘  â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â–’â–‘â–’â–’    â–’â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’â–‘â–‘â–’â–’â–’   â–’â–’â–’         ......................................
.....................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   â–’   â–’â–’â–’â–’â–’â–’â–’â–‘â–’â–’â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–’â–’â–’   â–’â–’          ......................................
.....................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘      â–’â–’â–’â–’â–’â–’â–’    â–’  â–‘â–‘â–‘â–’â–’â–’â–’  â–’â–’â–’          ......................................
......................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â–’â–‘â–’â–’â–’ â–’â–’â–’    â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’   â–’â–’â–’â–’      â–’   .......................................
......................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’  â–‘â–‘â–’â–’â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’  â–‘â–’â–’â–’â–’       â–’   .......................................
......................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’ â–’â–’â–‘â–’â–’â–’â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â–‘â–‘â–’â–’â–’â–’â–’       â–’   .......................................
......................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’ â–‘â–’â–’â–’â–’â–’â–’â–’â–’â–’â–‘â–‘â–’â–‘â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–’â–’â–’â–’â–’â–’      â–’    .......................................
.......................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–‘â–‘â–’â–‘â–’â–’â–’ â–’â–’â–’â–’â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’        â–’    .......................................
.......................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–‘â–’â–’â–’â–’â–’     â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’        â–’    .......................................
.......................................â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–‘â–‘â–’â–‘â–’â–’â–’â–’â–’â–’  â–’â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–’â–’â–’â–’â–’â–’        â–’     .......................................
NINJA_EOF

    echo ""
    echo -e "                                    \033[1;35mã€Œ å¤©ä¸‹å¸ƒæ­¦ï¼å‹åˆ©ã‚’æ´ã‚ï¼ ã€\033[0m"
    echo ""
    echo -e "                               \033[0;36m[ASCII Art: syntax-samurai/ryu - CC0 1.0 Public Domain]\033[0m"
    echo ""

    # CLIã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸèµ·å‹•å¾…æ©Ÿãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    if [ "$KARO_CLI" = "claude" ]; then
        echo "  Claude Code ã®èµ·å‹•ã‚’å¾…æ©Ÿä¸­ï¼ˆæœ€å¤§30ç§’ï¼‰..."
    else
        CLI_NAME=$(get_cli_display_name "$KARO_CLI" 2>/dev/null || echo "$KARO_CLI")
        echo "  $CLI_NAME ã®èµ·å‹•ã‚’å¾…æ©Ÿä¸­ï¼ˆæœ€å¤§30ç§’ï¼‰..."
    fi

    # å®¶è€ã®èµ·å‹•ã‚’ç¢ºèªï¼ˆæœ€å¤§30ç§’å¾…æ©Ÿï¼‰
    for i in {1..30}; do
        # CLIã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸèµ·å‹•ç¢ºèª
        if [ "$KARO_CLI" = "claude" ]; then
            # Claude Codeã¯"bypass permissions"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒã‚§ãƒƒã‚¯
            if tmux capture-pane -t karo -p | grep -q "bypass permissions"; then
                echo "  â””â”€ å®¶è€ã® Claude Code èµ·å‹•ç¢ºèªå®Œäº†ï¼ˆ${i}ç§’ï¼‰"
                break
            fi
        else
            # ãã®ä»–ã®CLIã¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¡¨ç¤ºã‚’ãƒã‚§ãƒƒã‚¯
            if tmux capture-pane -t karo -p | grep -q -E "(>|â¯|$)"; then
                CLI_NAME=$(get_cli_display_name "$KARO_CLI" 2>/dev/null || echo "$KARO_CLI")
                echo "  â””â”€ å®¶è€ã® $CLI_NAME èµ·å‹•ç¢ºèªå®Œäº†ï¼ˆ${i}ç§’ï¼‰"
                break
            fi
        fi
        sleep 1
    done

    # å®¶è€ã«æŒ‡ç¤ºæ›¸ã‚’èª­ã¿è¾¼ã¾ã›ã‚‹
    log_info "  â””â”€ å®¶è€ã«æŒ‡ç¤ºæ›¸ã‚’ä¼é”ä¸­..."
    tmux send-keys -t karo "instructions/karo.md ã‚’èª­ã‚“ã§å½¹å‰²ã‚’ç†è§£ã›ã‚ˆã€‚"
    sleep 0.5
    tmux send-keys -t karo Enter

    # éƒ¨å°†ã«æŒ‡ç¤ºæ›¸ã‚’èª­ã¿è¾¼ã¾ã›ã‚‹
    sleep 2
    log_info "  â””â”€ éƒ¨å°†ã«æŒ‡ç¤ºæ›¸ã‚’ä¼é”ä¸­..."
    tmux send-keys -t "multiagent:0.0" "instructions/busho.md ã‚’èª­ã‚“ã§å½¹å‰²ã‚’ç†è§£ã›ã‚ˆã€‚"
    sleep 0.5
    tmux send-keys -t "multiagent:0.0" Enter

    # è¶³è»½å¤§å°† + è¶³è»½ã«æŒ‡ç¤ºæ›¸ã‚’èª­ã¿è¾¼ã¾ã›ã‚‹ï¼ˆä¸¦åˆ—å‡¦ç†ï¼‰
    # æ³¨æ„: å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®CLIèµ·å‹•å®Œäº†ã‚’ç¢ºèªã—ã¦ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹
    sleep 2
    log_info "  â””â”€ è¶³è»½å¤§å°†ãƒ»è¶³è»½ã«æŒ‡ç¤ºæ›¸ã‚’ä¼é”ä¸­ï¼ˆä¸¦åˆ—ï¼‰..."
    
    # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
    ASYNC_RESULT_DIR=$(mktemp -d)
    
    # --- ä¸¦åˆ—å¾…æ©Ÿãƒ»é€ä¿¡é–¢æ•° ---
    # å¼•æ•°: $1=ãƒšã‚¤ãƒ³ç•ªå·, $2=ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå, $3=CLIç¨®åˆ¥, $4=é€ä¿¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸, $5=çµæœãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
    wait_and_send_async() {
        local pane_num=$1
        local agent_name=$2
        local cli_type=$3
        local message=$4
        local result_file=$5
        local max_wait=300  # æœ€å¤§300ç§’å¾…æ©Ÿ
        local ready=false
        local pane_output=""
        
        # Crushã¯è¡¨ç¤ºé ˜åŸŸã«ä¾å­˜ã™ã‚‹ãŸã‚ã€å›ºå®šæ™‚é–“å¾…æ©Ÿ+é€ä¿¡æˆåŠŸç¢ºèªãƒ«ãƒ¼ãƒ—ã‚’ä½¿ç”¨
        if [ "$cli_type" = "crush" ]; then
            local max_retries=5
            local retry_wait=5
            wait_count=0
            
            for retry in $(seq 1 $max_retries); do
                # èµ·å‹•å¾…æ©Ÿ
                sleep $retry_wait
                wait_count=$((wait_count + retry_wait))
                
                # é€ä¿¡å‰ã®ãƒšã‚¤ãƒ³å†…å®¹ã‚’è¨˜éŒ²
                local before_content
                before_content=$(tmux capture-pane -t "multiagent:0.$pane_num" -p -S - -E - 2>/dev/null)
                
                # æŒ‡ç¤ºæ›¸ã‚’é€ä¿¡
                tmux send-keys -t "multiagent:0.$pane_num" "$message"
                sleep 0.3
                tmux send-keys -t "multiagent:0.$pane_num" Enter
                
                # å¿œç­”ã‚’å¾…æ©Ÿ
                sleep 3
                wait_count=$((wait_count + 3))
                
                # é€ä¿¡å¾Œã®ãƒšã‚¤ãƒ³å†…å®¹ã‚’ç¢ºèª
                local after_content
                after_content=$(tmux capture-pane -t "multiagent:0.$pane_num" -p -S - -E - 2>/dev/null)
                
                # å†…å®¹ãŒå¤‰åŒ–ã—ã¦ã„ãŸã‚‰æˆåŠŸï¼ˆCLIãŒå¿œç­”ã—ãŸï¼‰
                if [ "$before_content" != "$after_content" ]; then
                    ready=true
                    break
                fi
                # å¤‰åŒ–ãŒãªã‘ã‚Œã°æ¬¡ã®ãƒªãƒˆãƒ©ã‚¤ã¸
            done
            
            # Crushã¯ã“ã“ã§å‡¦ç†å®Œäº†ï¼ˆæˆåŠŸ/å¤±æ•—ã¯å¾Œæ®µã§åˆ¤å®šï¼‰
        else
            for wait_count in $(seq 1 $max_wait); do
                # ãƒšã‚¤ãƒ³å‡ºåŠ›ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ï¼ˆ-S - ã§å±¥æ­´å…¨ä½“ã€-E - ã§æœ€å¾Œã¾ã§ï¼‰
                pane_output=$(tmux capture-pane -t "multiagent:0.$pane_num" -p -S - -E - 2>/dev/null)
                
                case "$cli_type" in
                    claude)
                        # Claude Code: "bypass permissions on" ãŒè¡¨ç¤ºã•ã‚Œã‚‹
                        if echo "$pane_output" | grep -q "bypass permissions"; then
                            ready=true
                            break
                        fi
                        ;;
                    copilot)
                        # Copilot: "Type @ to mention files" ãŒè¡¨ç¤ºã•ã‚Œã‚‹
                        if echo "$pane_output" | grep -q "Type @ to mention"; then
                            ready=true
                            break
                        fi
                        ;;
                    gemini)
                        # Gemini: "Tips for getting started" ã¾ãŸã¯ "/help for more" ãŒè¡¨ç¤ºã•ã‚Œã‚‹
                        if echo "$pane_output" | grep -q -E "(Tips for getting started|/help for more)"; then
                            ready=true
                            break
                        fi
                        ;;
                    *)
                        # ãã®ä»–: æ±ç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ¤œå‡º
                        if echo "$pane_output" | grep -q -E "(>|â¯|\$)"; then
                            ready=true
                            break
                        fi
                        ;;
                esac
                sleep 1
            done
        fi
        
        if [ "$ready" = true ]; then
            # Crushã¯ãƒ«ãƒ¼ãƒ—å†…ã§æ—¢ã«é€ä¿¡æ¸ˆã¿ãªã®ã§ã‚¹ã‚­ãƒƒãƒ—
            if [ "$cli_type" != "crush" ]; then
                tmux send-keys -t "multiagent:0.$pane_num" "$message"
                sleep 0.3
                tmux send-keys -t "multiagent:0.$pane_num" Enter
            fi
            echo "success:${agent_name}:${pane_num}:${wait_count}" > "$result_file"
        else
            echo "timeout:${agent_name}:${pane_num}:${max_wait}" > "$result_file"
        fi
    }
    
    # --- è¶³è»½å¤§å°†ï¼ˆãƒšã‚¤ãƒ³1ï¼‰ã‚’ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•å¾…æ©Ÿ ---
    DAISHO_NAME="ashigaru-daisho"
    DAISHO_MSG="instructions/ashigaru-daisho.md ã‚’èª­ã‚“ã§å½¹å‰²ã‚’ç†è§£ã›ã‚ˆã€‚æ±ã¯è¶³è»½å¤§å°†ã§ã‚ã‚‹ã€‚"
    if [ "$CLI_ADAPTER_AVAILABLE" = true ]; then
        DAISHO_CLI=$(get_cli_type "$DAISHO_NAME" "$CONFIG_FILE")
    else
        DAISHO_CLI="claude"
    fi
    log_info "      â””â”€ è¶³è»½å¤§å°† ($DAISHO_CLI) ã®èµ·å‹•å¾…æ©Ÿã‚’é–‹å§‹..."
    wait_and_send_async 1 "$DAISHO_NAME" "$DAISHO_CLI" "$DAISHO_MSG" "$ASYNC_RESULT_DIR/daisho.result" &
    DAISHO_PID=$!
    
    # --- è¶³è»½2-8ã‚’ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•å¾…æ©Ÿ ---
    declare -a ASHIGARU_PIDS
    for i in {2..8}; do
        ASHIGARU_NAME="ashigaru${i}"
        ASHIGARU_MSG="instructions/ashigaru.md ã‚’èª­ã‚“ã§å½¹å‰²ã‚’ç†è§£ã›ã‚ˆã€‚æ±ã¯è¶³è»½${i}å·ã§ã‚ã‚‹ã€‚"
        
        if [ "$CLI_ADAPTER_AVAILABLE" = true ]; then
            ASHIGARU_CLI=$(get_cli_type "$ASHIGARU_NAME" "$CONFIG_FILE")
        else
            ASHIGARU_CLI="claude"
        fi
        
        log_info "      â””â”€ è¶³è»½${i} ($ASHIGARU_CLI) ã®èµ·å‹•å¾…æ©Ÿã‚’é–‹å§‹..."
        wait_and_send_async "$i" "$ASHIGARU_NAME" "$ASHIGARU_CLI" "$ASHIGARU_MSG" "$ASYNC_RESULT_DIR/ashigaru${i}.result" &
        ASHIGARU_PIDS+=($!)
    done
    
    # --- å…¨ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã®å®Œäº†ã‚’å¾…æ©Ÿ ---
    log_info "      â””â”€ å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®èµ·å‹•å®Œäº†ã‚’å¾…æ©Ÿä¸­..."
    wait $DAISHO_PID
    for pid in "${ASHIGARU_PIDS[@]}"; do
        wait $pid
    done
    
    # --- çµæœã‚’ç¢ºèªãƒ»è¡¨ç¤º ---
    echo ""
    log_info "  â””â”€ æŒ‡ç¤ºæ›¸ä¼é”çµæœ:"
    
    # è¶³è»½å¤§å°†ã®çµæœ
    if [ -f "$ASYNC_RESULT_DIR/daisho.result" ]; then
        DAISHO_RESULT=$(cat "$ASYNC_RESULT_DIR/daisho.result")
        IFS=':' read -r RESULT_STATUS RESULT_AGENT RESULT_PANE RESULT_WAIT <<< "$DAISHO_RESULT"
        if [ "$RESULT_STATUS" = "success" ]; then
            log_success "      â””â”€ è¶³è»½å¤§å°†: æŒ‡ç¤ºæ›¸ä¼é”å®Œäº†ï¼ˆ${RESULT_WAIT}ç§’, ${RESULT_AGENT}, pane ${RESULT_PANE}ï¼‰"
        else
            log_error "      â””â”€ è¶³è»½å¤§å°†: èµ·å‹•ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆ${RESULT_WAIT}ç§’, ${RESULT_AGENT}, pane ${RESULT_PANE}ï¼‰"
        fi
    fi
    
    # è¶³è»½2-8ã®çµæœ
    for i in {2..8}; do
        if [ -f "$ASYNC_RESULT_DIR/ashigaru${i}.result" ]; then
            RESULT=$(cat "$ASYNC_RESULT_DIR/ashigaru${i}.result")
            IFS=':' read -r RESULT_STATUS RESULT_AGENT RESULT_PANE RESULT_WAIT <<< "$RESULT"
            if [ "$RESULT_STATUS" = "success" ]; then
                log_success "      â””â”€ è¶³è»½${i}: æŒ‡ç¤ºæ›¸ä¼é”å®Œäº†ï¼ˆ${RESULT_WAIT}ç§’, ${RESULT_AGENT}, pane ${RESULT_PANE}ï¼‰"
            else
                log_error "      â””â”€ è¶³è»½${i}: èµ·å‹•ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆ${RESULT_WAIT}ç§’, ${RESULT_AGENT}, pane ${RESULT_PANE}ï¼‰"
            fi
        fi
    done
    
    # ä¸€æ™‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‰Šé™¤
    rm -rf "$ASYNC_RESULT_DIR"
    
    log_success "âœ… å…¨è»ã«æŒ‡ç¤ºæ›¸ä¼é”å®Œäº†"
    echo ""
fi

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 7: ç’°å¢ƒç¢ºèªãƒ»å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
log_info "ğŸ” é™£å®¹ã‚’ç¢ºèªä¸­..."
echo ""
echo "  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "  â”‚  ğŸ“º Tmuxé™£å®¹ (Sessions)                                  â”‚"
echo "  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
tmux list-sessions | sed 's/^/     /'
echo ""
echo "  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "  â”‚  ğŸ“‹ å¸ƒé™£å›³ (Formation)                                   â”‚"
echo "  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""
echo "     ã€karoã‚»ãƒƒã‚·ãƒ§ãƒ³ã€‘å®¶è€ã®æœ¬é™£"
echo "     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "     â”‚  Pane 0: å®¶è€ (KARO)        â”‚  â† ç·å¤§å°†ãƒ»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçµ±æ‹¬"
echo "     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""
echo "     ã€multiagentã‚»ãƒƒã‚·ãƒ§ãƒ³ã€‘éƒ¨å°†ãƒ»è¶³è»½å¤§å°†ãƒ»è¶³è»½ã®é™£ï¼ˆ3x3 = 9ãƒšã‚¤ãƒ³ï¼‰"
echo "     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "     â”‚  busho  â”‚ashigaru3â”‚ashigaru6â”‚"
echo "     â”‚  (éƒ¨å°†) â”‚ (è¶³è»½3) â”‚ (è¶³è»½6)  â”‚"
echo "     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
echo "     â”‚  daisho â”‚ashigaru4â”‚ashigaru7â”‚"
echo "     â”‚(è¶³è»½å¤§å°†)â”‚ (è¶³è»½4)  â”‚ (è¶³è»½7)  â”‚"
echo "     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
echo "     â”‚ashigaru2â”‚ashigaru5â”‚ashigaru8â”‚"
echo "     â”‚ (è¶³è»½2)  â”‚ (è¶³è»½5) â”‚ (è¶³è»½8)  â”‚"
echo "     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""

echo ""
echo "  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "  â•‘  ğŸ¯ å‡ºé™£æº–å‚™å®Œäº†ï¼å¤©ä¸‹å¸ƒæ­¦ï¼                                 â•‘"
echo "  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

if [ "$SETUP_ONLY" = true ]; then
    # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ã¿ãƒ¢ãƒ¼ãƒ‰ã§ã‚‚CLIã‚¿ã‚¤ãƒ—ã‚’åˆ¤å®š
    if [ -z "$KARO_CLI" ]; then
        if [ -n "$FORCE_CLI" ]; then
            KARO_CLI="$FORCE_CLI"
        elif [ "$CLI_ADAPTER_AVAILABLE" = true ] && [ -f "./config/settings.yaml" ]; then
            KARO_CLI=$(get_cli_type "karo" "./config/settings.yaml")
        else
            KARO_CLI="claude"
        fi
    fi

    # CLIã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    if [ "$KARO_CLI" = "claude" ]; then
        echo "  âš ï¸  ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ã¿ãƒ¢ãƒ¼ãƒ‰: Claude Codeã¯æœªèµ·å‹•ã§ã™"
        echo ""
        echo "  æ‰‹å‹•ã§Claude Codeã‚’èµ·å‹•ã™ã‚‹ã«ã¯:"
        echo "  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
        echo "  â”‚  # å®¶è€ã‚’å¬å–š                                              â”‚"
        echo "  â”‚  tmux send-keys -t karo 'claude --dangerously-skip-permissions' Enter â”‚"
        echo "  â”‚                                                          â”‚"
        echo "  â”‚  # éƒ¨å°†ãƒ»è¶³è»½ã‚’ä¸€æ–‰å¬å–š                                     â”‚"
        echo "  â”‚  for i in {0..8}; do \\                                  â”‚"
        echo "  â”‚    tmux send-keys -t multiagent:0.\$i \\                 â”‚"
        echo "  â”‚      'claude --dangerously-skip-permissions' Enter       â”‚"
        echo "  â”‚  done                                                    â”‚"
        echo "  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
    elif [ "$KARO_CLI" = "glm" ]; then
        echo "  âš ï¸  ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ã¿ãƒ¢ãƒ¼ãƒ‰: GLM Coding Plan ã¯æœªèµ·å‹•ã§ã™"
        echo ""
        echo "  æ‰‹å‹•ã§GLM Coding Plan ã‚’èµ·å‹•ã™ã‚‹ã«ã¯:"
        echo "  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
        echo "  â”‚  # å®¶è€ã‚’å¬å–š                                              â”‚"
        echo "  â”‚  tmux send-keys -t karo 'glm --dangerously-skip-permissions' Enter â”‚"
        echo "  â”‚                                                          â”‚"
        echo "  â”‚  # éƒ¨å°†ãƒ»è¶³è»½ã‚’ä¸€æ–‰å¬å–š                                      â”‚"
        echo "  â”‚  for i in {0..8}; do \\                                  â”‚"
        echo "  â”‚    tmux send-keys -t multiagent:0.\$i \\                 â”‚"
        echo "  â”‚      'glm --dangerously-skip-permissions' Enter          â”‚"
        echo "  â”‚  done                                                    â”‚"
        echo "  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
    else
        CLI_NAME=$(get_cli_display_name "$KARO_CLI" 2>/dev/null || echo "$KARO_CLI")
        echo "  âš ï¸  ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ã¿ãƒ¢ãƒ¼ãƒ‰: ${CLI_NAME}ã¯æœªèµ·å‹•ã§ã™"
        echo ""
        echo "  æ‰‹å‹•ã§${CLI_NAME}ã‚’èµ·å‹•ã™ã‚‹ã«ã¯ config/settings.yaml ã‚’ç¢ºèªã—ã¦ãã ã•ã„"
    fi
    echo ""
fi

echo "  æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:"
echo "  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "  â”‚  å®¶è€ã®æœ¬é™£ã«ã‚¢ã‚¿ãƒƒãƒã—ã¦å‘½ä»¤ã‚’é–‹å§‹:                      â”‚"
echo "  â”‚     tmux attach-session -t karo   (ã¾ãŸã¯: csk)          â”‚"
echo "  â”‚                                                          â”‚"
echo "  â”‚  éƒ¨å°†ãƒ»è¶³è»½ã®é™£ã‚’ç¢ºèªã™ã‚‹:                                â”‚"
echo "  â”‚     tmux attach-session -t multiagent   (ã¾ãŸã¯: csm)    â”‚"
echo "  â”‚                                                          â”‚"
echo "  â”‚  â€» å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯æŒ‡ç¤ºæ›¸ã‚’èª­ã¿è¾¼ã¿æ¸ˆã¿ã€‚                 â”‚"
echo "  â”‚    ã™ãã«å‘½ä»¤ã‚’é–‹å§‹ã§ãã¾ã™ã€‚                             â”‚"
echo "  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""
echo "  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "   å¤©ä¸‹å¸ƒæ­¦ï¼å‹åˆ©ã‚’æ´ã‚ï¼ (Tenka Fubu! Seize victory!)"
echo "  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# STEP 8: Windows Terminal ã§ã‚¿ãƒ–ã‚’é–‹ãï¼ˆ-t ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ™‚ã®ã¿ï¼‰
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
if [ "$OPEN_TERMINAL" = true ]; then
    log_info "ğŸ“º Windows Terminal ã§ã‚¿ãƒ–ã‚’å±•é–‹ä¸­..."

    # Windows Terminal ãŒåˆ©ç”¨å¯èƒ½ã‹ç¢ºèª
    if command -v wt.exe &> /dev/null; then
        wt.exe -w 0 new-tab wsl.exe -e bash -c "tmux attach-session -t karo" \; new-tab wsl.exe -e bash -c "tmux attach-session -t multiagent"
        log_success "  â””â”€ ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¿ãƒ–å±•é–‹å®Œäº†"
    else
        log_info "  â””â”€ wt.exe ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚æ‰‹å‹•ã§ã‚¢ã‚¿ãƒƒãƒã—ã¦ãã ã•ã„ã€‚"
    fi
    echo ""
fi
